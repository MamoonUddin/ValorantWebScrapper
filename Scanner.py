from classes import ProfileScanner
import pandas as pd 
from selenium import webdriver
from time import sleep
import time
import os

#old column names
#columnName = ['User Name', 'Tag', 'Source', 'currentRank', 'currentMMR', 'peakRank', 'peakMMR', 'headShotPercent', 'headShotHit', 'bodyShotPercent', 'bodyShotHit', 'legShotPercent', 'legShotHit', 'firstTopWeponLabel', 'firstTopWeponType', 'firstTopWeponKills', 'secondTopWeponLabel', 'secondTopWeponType', 'secondTopWeponKills', 'thirdTopWeponLabel', 'thirdTopWeponType', 'thirdTopWeponKills', 'Bind Win', 'Bind Loss', 'Ascent Win', 'Ascent Loss', 'Fracture Win', 'Fracture Loss', 'Haven Win', 'Haven Loss', 'Breeze Win', 'Breeze Loss', 'Icebox Win', 'Icebox Loss', 'Pearl Win', 'Pearl Loss', 'Wins', 'Loss', 'Damage/Round', 'K/D Ratio', 'Win %', 'Kills', 'Deaths', 'Assists', 'Score/Round', 'KAD Ratio', 'Kills/Round', 'Plants', 'First Bloods', 'Clutches', 'Flawless', 'Aces', 'Ares-Kills', 'Ares-Death', 'Ares-HeadShot%', 'Ares-Damage/Round', 'Ares-kills/Round', 'Ares-Longest Kill Distance', 'Bucky-Kills', 'Bucky-Death', 'Bucky-HeadShot%', 'Bucky-Damage/Round', 'Bucky-kills/Round', 'Bucky-Longest Kill Distance', 'Bulldog-Kills', 'Bulldog-Death', 'Bulldog-HeadShot%', 'Bulldog-Damage/Round', 'Bulldog-kills/Round', 'Bulldog-Longest Kill Distance', 'Classic-Kills', 'Classic-Death', 'Classic-HeadShot%', 'Classic-Damage/Round', 'Classic-kills/Round', 'Classic-Longest Kill Distance', 'Frenzy-Kills', 'Frenzy-Death', 'Frenzy-HeadShot%', 'Frenzy-Damage/Round', 'Frenzy-kills/Round', 'Frenzy-Longest Kill Distance', 'Ghost-Kills', 'Ghost-Death', 'Ghost-HeadShot%', 'Ghost-Damage/Round', 'Ghost-kills/Round', 'Ghost-Longest Kill Distance', 'Guardian-Kills', 'Guardian-Death', 'Guardian-HeadShot%', 'Guardian-Damage/Round', 'Guardian-kills/Round', 'Guardian-Longest Kill Distance', 'Judge-Kills', 'Judge-Death', 'Judge-HeadShot%', 'Judge-Damage/Round', 'Judge-kills/Round', 'Judge-Longest Kill Distance', 'Marshal-Kills', 'Marshal-Death', 'Marshal-HeadShot%', 'Marshal-Damage/Round', 'Marshal-kills/Round', 'Marshal-Longest Kill Distance', 'Melee-Kills', 'Melee-Death', 'Melee-HeadShot%', 'Melee-Damage/Round', 'Melee-kills/Round', 'Melee-Longest Kill Distance', 'Odin-Kills', 'Odin-Death', 'Odin-HeadShot%', 'Odin-Damage/Round', 'Odin-kills/Round', 'Odin-Longest Kill Distance', 'Operator-Kills', 'Operator-Death', 'Operator-HeadShot%', 'Operator-Damage/Round', 'Operator-kills/Round', 'Operator-Longest Kill Distance', 'Phantom-Kills', 'Phantom-Death', 'Phantom-HeadShot%', 'Phantom-Damage/Round', 'Phantom-kills/Round', 'Phantom-Longest Kill Distance', 'Sheriff-Kills', 'Sheriff-Death', 'Sheriff-HeadShot%', 'Sheriff-Damage/Round', 'Sheriff-kills/Round', 'Sheriff-Longest Kill Distance', 'Shorty-Kills', 'Shorty-Death', 'Shorty-HeadShot%', 'Shorty-Damage/Round', 'Shorty-kills/Round', 'Shorty-Longest Kill Distance', 'Spectre-Kills', 'Spectre-Death', 'Spectre-HeadShot%', 'Spectre-Damage/Round', 'Spectre-kills/Round', 'Spectre-Longest Kill Distance', 'Stinger-Kills', 'Stinger-Death', 'Stinger-HeadShot%', 'Stinger-Damage/Round', 'Stinger-kills/Round', 'Stinger-Longest Kill Distance', 'Vandal-Kills', 'Vandal-Death', 'Vandal-HeadShot%', 'Vandal-Damage/Round', 'Vandal-kills/Round', 'Vandal-Longest Kill Distance', 'Astra-TimePlayer', 'Astra-Matches', 'Astra-Win%', 'Astra-K/D', 'Astra-ADR', 'Astra-HS%', 'Astra-KAST', 'Astra-AttackWinLoss', 'Astra-AttackWin%', 'Astra-AttackK/D', 'Astra-DefenseWinLoss', 'Astra-DefenseWin%', 'Astra-DefenseK/D', 'Breach-TimePlayer', 'Breach-Matches', 'Breach-Win%', 'Breach-K/D', 'Breach-ADR', 'Breach-HS%', 'Breach-KAST', 'Breach-AttackWinLoss', 'Breach-AttackWin%', 'Breach-AttackK/D', 'Breach-DefenseWinLoss', 'Breach-DefenseWin%', 'Breach-DefenseK/D', 'Brimstone-TimePlayer', 'Brimstone-Matches', 'Brimstone-Win%', 'Brimstone-K/D', 'Brimstone-ADR', 'Brimstone-HS%', 'Brimstone-KAST', 'Brimstone-AttackWinLoss', 'Brimstone-AttackWin%', 'Brimstone-AttackK/D', 'Brimstone-DefenseWinLoss', 'Brimstone-DefenseWin%', 'Brimstone-DefenseK/D', 'Chamber-TimePlayer', 'Chamber-Matches', 'Chamber-Win%', 'Chamber-K/D', 'Chamber-ADR', 'Chamber-HS%', 'Chamber-KAST', 'Chamber-AttackWinLoss', 'Chamber-AttackWin%', 'Chamber-AttackK/D', 'Chamber-DefenseWinLoss', 'Chamber-DefenseWin%', 'Chamber-DefenseK/D', 'Cypher-TimePlayer', 'Cypher-Matches', 'Cypher-Win%', 'Cypher-K/D', 'Cypher-ADR', 'Cypher-HS%', 'Cypher-KAST', 'Cypher-AttackWinLoss', 'Cypher-AttackWin%', 'Cypher-AttackK/D', 'Cypher-DefenseWinLoss', 'Cypher-DefenseWin%', 'Cypher-DefenseK/D', 'Fade-TimePlayer', 'Fade-Matches', 'Fade-Win%', 'Fade-K/D', 'Fade-ADR', 'Fade-HS%', 'Fade-KAST', 'Fade-AttackWinLoss', 'Fade-AttackWin%', 'Fade-AttackK/D', 'Fade-DefenseWinLoss', 'Fade-DefenseWin%', 'Fade-DefenseK/D', 'Harbor-TimePlayer', 'Harbor-Matches', 'Harbor-Win%', 'Harbor-K/D', 'Harbor-ADR', 'Harbor-HS%', 'Harbor-KAST', 'Harbor-AttackWinLoss', 'Harbor-AttackWin%', 'Harbor-AttackK/D', 'Harbor-DefenseWinLoss', 'Harbor-DefenseWin%', 'Harbor-DefenseK/D', 'Jett-TimePlayer', 'Jett-Matches', 'Jett-Win%', 'Jett-K/D', 'Jett-ADR', 'Jett-HS%', 'Jett-KAST', 'Jett-AttackWinLoss', 'Jett-AttackWin%', 'Jett-AttackK/D', 'Jett-DefenseWinLoss', 'Jett-DefenseWin%', 'Jett-DefenseK/D', 'KAY/O-TimePlayer', 'KAY/O-Matches', 'KAY/O-Win%', 'KAY/O-K/D', 'KAY/O-ADR', 'KAY/O-HS%', 'KAY/O-KAST', 'KAY/O-AttackWinLoss', 'KAY/O-AttackWin%', 'KAY/O-AttackK/D', 'KAY/O-DefenseWinLoss', 'KAY/O-DefenseWin%', 'KAY/O-DefenseK/D', 'Killjoy-TimePlayer', 'Killjoy-Matches', 'Killjoy-Win%', 'Killjoy-K/D', 'Killjoy-ADR', 'Killjoy-HS%', 'Killjoy-KAST', 'Killjoy-AttackWinLoss', 'Killjoy-AttackWin%', 'Killjoy-AttackK/D', 'Killjoy-DefenseWinLoss', 'Killjoy-DefenseWin%', 'Killjoy-DefenseK/D', 'Neon-TimePlayer', 'Neon-Matches', 'Neon-Win%', 'Neon-K/D', 'Neon-ADR', 'Neon-HS%', 'Neon-KAST', 'Neon-AttackWinLoss', 'Neon-AttackWin%', 'Neon-AttackK/D', 'Neon-DefenseWinLoss', 'Neon-DefenseWin%', 'Neon-DefenseK/D', 'Omen-TimePlayer', 'Omen-Matches', 'Omen-Win%', 'Omen-K/D', 'Omen-ADR', 'Omen-HS%', 'Omen-KAST', 'Omen-AttackWinLoss', 'Omen-AttackWin%', 'Omen-AttackK/D', 'Omen-DefenseWinLoss', 'Omen-DefenseWin%', 'Omen-DefenseK/D', 'Phoenix-TimePlayer', 'Phoenix-Matches', 'Phoenix-Win%', 'Phoenix-K/D', 'Phoenix-ADR', 'Phoenix-HS%', 'Phoenix-KAST', 'Phoenix-AttackWinLoss', 'Phoenix-AttackWin%', 'Phoenix-AttackK/D', 'Phoenix-DefenseWinLoss', 'Phoenix-DefenseWin%', 'Phoenix-DefenseK/D', 'Raze-TimePlayer', 'Raze-Matches', 'Raze-Win%', 'Raze-K/D', 'Raze-ADR', 'Raze-HS%', 'Raze-KAST', 'Raze-AttackWinLoss', 'Raze-AttackWin%', 'Raze-AttackK/D', 'Raze-DefenseWinLoss', 'Raze-DefenseWin%', 'Raze-DefenseK/D', 'Reyna-TimePlayer', 'Reyna-Matches', 'Reyna-Win%', 'Reyna-K/D', 'Reyna-ADR', 'Reyna-HS%', 'Reyna-KAST', 'Reyna-AttackWinLoss', 'Reyna-AttackWin%', 'Reyna-AttackK/D', 'Reyna-DefenseWinLoss', 'Reyna-DefenseWin%', 'Reyna-DefenseK/D', 'Sage-TimePlayer', 'Sage-Matches', 'Sage-Win%', 'Sage-K/D', 'Sage-ADR', 'Sage-HS%', 'Sage-KAST', 'Sage-AttackWinLoss', 'Sage-AttackWin%', 'Sage-AttackK/D', 'Sage-DefenseWinLoss', 'Sage-DefenseWin%', 'Sage-DefenseK/D', 'Skye-TimePlayer', 'Skye-Matches', 'Skye-Win%', 'Skye-K/D', 'Skye-ADR', 'Skye-HS%', 'Skye-KAST', 'Skye-AttackWinLoss', 'Skye-AttackWin%', 'Skye-AttackK/D', 'Skye-DefenseWinLoss', 'Skye-DefenseWin%', 'Skye-DefenseK/D', 'Sova-TimePlayer', 'Sova-Matches', 'Sova-Win%', 'Sova-K/D', 'Sova-ADR', 'Sova-HS%', 'Sova-KAST', 'Sova-AttackWinLoss', 'Sova-AttackWin%', 'Sova-AttackK/D', 'Sova-DefenseWinLoss', 'Sova-DefenseWin%', 'Sova-DefenseK/D', 'Viper-TimePlayer', 'Viper-Matches', 'Viper-Win%', 'Viper-K/D', 'Viper-ADR', 'Viper-HS%', 'Viper-KAST', 'Viper-AttackWinLoss', 'Viper-AttackWin%', 'Viper-AttackK/D', 'Viper-DefenseWinLoss', 'Viper-DefenseWin%', 'Viper-DefenseK/D', 'Yoru-TimePlayer', 'Yoru-Matches', 'Yoru-Win%', 'Yoru-K/D', 'Yoru-ADR', 'Yoru-HS%', 'Yoru-KAST', 'Yoru-AttackWinLoss', 'Yoru-AttackWin%', 'Yoru-AttackK/D', 'Yoru-DefenseWinLoss', 'Yoru-DefenseWin%', 'Yoru-DefenseK/D'] 
columnName = ['User Name', 'Tag', 'Source', 'currentRank', 'currentMMR', 'peakRank', 'peakMMR', 'headShotPercent', 'headShotHit', 'bodyShotPercent', 'bodyShotHit', 'legShotPercent', 'legShotHit', 'firstTopWeponLabel', 'firstTopWeponType', 'firstTopWeponKills', 'secondTopWeponLabel', 'secondTopWeponType', 'secondTopWeponKills', 'thirdTopWeponLabel', 'thirdTopWeponType', 'thirdTopWeponKills', 'Bind Win', 'Bind Loss', 'Ascent Win', 'Ascent Loss', 'Fracture Win', 'Fracture Loss', 'Haven Win', 'Haven Loss', 'Breeze Win', 'Breeze Loss', 'Icebox Win', 'Icebox Loss', 'Pearl Win', 'Pearl Loss', 'Wins', 'Loss', 'Damage/Round', 'K/D Ratio', 'Win %', 'Kills', 'Deaths', 'Assists', 'Score/Round', 'KAD Ratio', 'Kills/Round', 'Plants', 'First Bloods', 'Clutches', 'Flawless', 'Aces', 'Ares-Kills', 'Ares-Death', 'Ares-HeadShot%', 'Ares-Damage/Round', 'Ares-kills/Round', 'Ares-Longest Kill Distance', 'Bucky-Kills', 'Bucky-Death', 'Bucky-HeadShot%', 'Bucky-Damage/Round', 'Bucky-kills/Round', 'Bucky-Longest Kill Distance', 'Bulldog-Kills', 'Bulldog-Death', 'Bulldog-HeadShot%', 'Bulldog-Damage/Round', 'Bulldog-kills/Round', 'Bulldog-Longest Kill Distance', 'Classic-Kills', 'Classic-Death', 'Classic-HeadShot%', 'Classic-Damage/Round', 'Classic-kills/Round', 'Classic-Longest Kill Distance', 'Frenzy-Kills', 'Frenzy-Death', 'Frenzy-HeadShot%', 'Frenzy-Damage/Round', 'Frenzy-kills/Round', 'Frenzy-Longest Kill Distance', 'Ghost-Kills', 'Ghost-Death', 'Ghost-HeadShot%', 'Ghost-Damage/Round', 'Ghost-kills/Round', 'Ghost-Longest Kill Distance', 'Guardian-Kills', 'Guardian-Death', 'Guardian-HeadShot%', 'Guardian-Damage/Round', 'Guardian-kills/Round', 'Guardian-Longest Kill Distance', 'Judge-Kills', 'Judge-Death', 'Judge-HeadShot%', 'Judge-Damage/Round', 'Judge-kills/Round', 'Judge-Longest Kill Distance', 'Marshal-Kills', 'Marshal-Death', 'Marshal-HeadShot%', 'Marshal-Damage/Round', 'Marshal-kills/Round', 'Marshal-Longest Kill Distance', 'Melee-Kills', 'Melee-Death', 'Melee-HeadShot%', 'Melee-Damage/Round', 'Melee-kills/Round', 'Melee-Longest Kill Distance', 'Odin-Kills', 'Odin-Death', 'Odin-HeadShot%', 'Odin-Damage/Round', 'Odin-kills/Round', 'Odin-Longest Kill Distance', 'Operator-Kills', 'Operator-Death', 'Operator-HeadShot%', 'Operator-Damage/Round', 'Operator-kills/Round', 'Operator-Longest Kill Distance', 'Phantom-Kills', 'Phantom-Death', 'Phantom-HeadShot%', 'Phantom-Damage/Round', 'Phantom-kills/Round', 'Phantom-Longest Kill Distance', 'Sheriff-Kills', 'Sheriff-Death', 'Sheriff-HeadShot%', 'Sheriff-Damage/Round', 'Sheriff-kills/Round', 'Sheriff-Longest Kill Distance', 'Shorty-Kills', 'Shorty-Death', 'Shorty-HeadShot%', 'Shorty-Damage/Round', 'Shorty-kills/Round', 'Shorty-Longest Kill Distance', 'Spectre-Kills', 'Spectre-Death', 'Spectre-HeadShot%', 'Spectre-Damage/Round', 'Spectre-kills/Round', 'Spectre-Longest Kill Distance', 'Stinger-Kills', 'Stinger-Death', 'Stinger-HeadShot%', 'Stinger-Damage/Round', 'Stinger-kills/Round', 'Stinger-Longest Kill Distance', 'Vandal-Kills', 'Vandal-Death', 'Vandal-HeadShot%', 'Vandal-Damage/Round', 'Vandal-kills/Round', 'Vandal-Longest Kill Distance','Astra-TimePlayer', 'Astra-Matches', 'Astra-Win%', 'Astra-K/D', 'Astra-ADR', 'Astra-ACS', 'Astra-HS%', 'Astra-KAST', 'Breach-TimePlayer', 'Breach-Matches', 'Breach-Win%', 'Breach-K/D', 'Breach-ADR', 'Breach-ACS', 'Breach-HS%', 'Breach-KAST', 'Brimstone-TimePlayer', 'Brimstone-Matches', 'Brimstone-Win%', 'Brimstone-K/D', 'Brimstone-ADR', 'Brimstone-ACS', 'Brimstone-HS%', 'Brimstone-KAST', 'Chamber-TimePlayer', 'Chamber-Matches', 'Chamber-Win%', 'Chamber-K/D', 'Chamber-ADR', 'Chamber-ACS', 'Chamber-HS%', 'Chamber-KAST', 'Cypher-TimePlayer', 'Cypher-Matches', 'Cypher-Win%', 'Cypher-K/D', 'Cypher-ADR', 'Cypher-ACS', 'Cypher-HS%', 'Cypher-KAST', 'Fade-TimePlayer', 'Fade-Matches', 'Fade-Win%', 'Fade-K/D', 'Fade-ADR', 'Fade-ACS', 'Fade-HS%', 'Fade-KAST', 'Harbor-TimePlayer', 'Harbor-Matches', 'Harbor-Win%', 'Harbor-K/D', 'Harbor-ADR', 'Harbor-ACS', 'Harbor-HS%', 'Harbor-KAST', 'Jett-TimePlayer', 'Jett-Matches', 'Jett-Win%', 'Jett-K/D', 'Jett-ADR', 'Jett-ACS', 'Jett-HS%', 'Jett-KAST', 'KAY/O-TimePlayer', 'KAY/O-Matches', 'KAY/O-Win%', 'KAY/O-K/D', 'KAY/O-ADR', 'KAY/O-ACS', 'KAY/O-HS%', 'KAY/O-KAST', 'Killjoy-TimePlayer', 'Killjoy-Matches', 'Killjoy-Win%', 'Killjoy-K/D', 'Killjoy-ADR', 'Killjoy-ACS', 'Killjoy-HS%', 'Killjoy-KAST', 'Neon-TimePlayer', 'Neon-Matches', 'Neon-Win%', 'Neon-K/D', 'Neon-ADR', 'Neon-ACS', 'Neon-HS%', 'Neon-KAST', 'Omen-TimePlayer', 'Omen-Matches', 'Omen-Win%', 'Omen-K/D', 'Omen-ADR', 'Omen-ACS', 'Omen-HS%', 'Omen-KAST', 'Phoenix-TimePlayer', 'Phoenix-Matches', 'Phoenix-Win%', 'Phoenix-K/D', 'Phoenix-ADR', 'Phoenix-ACS', 'Phoenix-HS%', 'Phoenix-KAST', 'Raze-TimePlayer', 'Raze-Matches', 'Raze-Win%', 'Raze-K/D', 'Raze-ADR', 'Raze-ACS', 'Raze-HS%', 'Raze-KAST', 'Reyna-TimePlayer', 'Reyna-Matches', 'Reyna-Win%', 'Reyna-K/D', 'Reyna-ADR', 'Reyna-ACS', 'Reyna-HS%', 'Reyna-KAST', 'Sage-TimePlayer', 'Sage-Matches', 'Sage-Win%', 'Sage-K/D', 'Sage-ADR', 'Sage-ACS', 'Sage-HS%', 'Sage-KAST', 'Skye-TimePlayer', 'Skye-Matches', 'Skye-Win%', 'Skye-K/D', 'Skye-ADR', 'Skye-ACS', 'Skye-HS%', 'Skye-KAST', 'Sova-TimePlayer', 'Sova-Matches', 'Sova-Win%', 'Sova-K/D', 'Sova-ADR', 'Sova-ACS', 'Sova-HS%', 'Sova-KAST', 'Viper-TimePlayer', 'Viper-Matches', 'Viper-Win%', 'Viper-K/D', 'Viper-ADR', 'Viper-ACS', 'Viper-HS%', 'Viper-KAST', 'Yoru-TimePlayer', 'Yoru-Matches', 'Yoru-Win%', 'Yoru-K/D', 'Yoru-ADR', 'Yoru-ACS', 'Yoru-HS%', 'Yoru-KAST'] 
df = pd.DataFrame(columns = columnName)

#timing
st = time.time()

def createDriver():
    driver = webdriver.Chrome(executable_path="C:\Coding\ValorantTrackerProject\chromedriver.exe") # for leader board
    return driver


for i in range(1,91): # orignal (1,91), for testing getting just getting all pages
    MainPage = createDriver()
    # changing url cause New act too recent
#   url = f"https://tracker.gg/valorant/leaderboards/ranked/all/default?page={i}"
    url = f"https://tracker.gg/valorant/leaderboards/ranked/all/default?page={i}&act=aca29595-40e4-01f5-3f35-b1b3d304c96e"
    MainPage.get(url)
    sleep(4)
    # change cause it change due too clicking Episode 5 act 3
   # players = MainPage.find_elements_by_xpath('//*[@id="app"]/div[2]/div[3]/div/main/div[3]/div[2]/div/div/div[1]/div[2]/table/tbody/tr')
    players = MainPage.find_elements_by_xpath('//*[@id="app"]/div[2]/div[3]/div/main/div[3]/div[2]/div/div/div[1]/div/table/tbody/tr')

    for player in players[0:5]: #change this to make changes on how many ppl per 100 in that page list , currently getting 5
        try : 
            link = player.find_element_by_tag_name('a').get_attribute('href')
            username = player.find_element_by_class_name('trn-ign__username').text
            tag = player.find_element_by_class_name('trn-ign__discriminator').text
            profileScanner = ProfileScanner(username,tag,link,columnName)
            profileScanner.setUrls()
            profileScanner.rank()
            profileScanner.accuracry()
            profileScanner.topWepon()
            profileScanner.mapInfo()
            profileScanner.winLossInfo()
            profileScanner.generalInfo()
            profileScanner.weponData()
            profileScanner.agentData()
            values = profileScanner.getDictionaryValues()
            profileScanner.exit()
            sleep(.5)
#           df.loc[len(df.index)] = values
            df.loc[len(df.index)] = values[0:320]    
        except :
            profileScanner.exit()
            continue
    MainPage.quit()


df.to_csv(os.getcwd()+'//Data-ValorantrawData.csv', index=False)

elapsed_time = time.time() - st
print('Execution time:', time.strftime("%H:%M:%S", time.gmtime(elapsed_time)))